<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>ArkTube - 시청</title>

  <!-- CSP (요청하신 그대로) -->
  <meta http-equiv="Content-Security-Policy" content="
  default-src 'self';

  connect-src 'self'
    https://www.googleapis.com
    https://firestore.googleapis.com
    https://securetoken.googleapis.com
    https://identitytoolkit.googleapis.com
    https://firebaseinstallations.googleapis.com
    https://firebase.googleapis.com
    https://www.gstatic.com
    https://www.google-analytics.com
    https://www.youtube.com
    https://i.ytimg.com;

  img-src 'self' data:
    https://i.ytimg.com
    https://www.google-analytics.com;

  frame-src
    https://www.youtube.com
    https://www.youtube-nocookie.com
    https://accounts.google.com
    https://www.google.com
    https://theark-3c896.firebaseapp.com
    https://theark-3c896.web.app;

  script-src 'self'
    https://www.gstatic.com
    https://apis.google.com
    https://www.googletagmanager.com
    'unsafe-inline';

  style-src 'self' 'unsafe-inline';
  object-src 'none';
  base-uri 'self';
">

  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#000000">
  <link rel="icon" href="/favicon.ico">

  <style>
    :root{
      --bg:#000; --bg-2:#111; --bg-3:#1b1b1b; --fg:#fff;
      --muted:#9aa0a6; --accent:#4ea1ff; --border:#333;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:system-ui,Segoe UI,Apple SD Gothic Neo,Arial,sans-serif; background:var(--bg); color:var(--fg);}

    /* 상단바 (뒤로가기 + 제목) */
    #topbar{
      position: fixed; top: 0; left: 0; right: 0; z-index: 20;
      display:flex; align-items:center; justify-content:space-between;
      height:52px; padding:0 12px; background:var(--bg-2); border-bottom:1px solid var(--border);
    }
    .brand{ display:flex; align-items:center; gap:10px; }
    .brand-logo{ height:40px; }
    .icon{ background:none; border:0; color:var(--fg); font-size:20px; cursor:pointer; padding:6px 8px; border-radius:6px; }
    .icon:hover{ background:var(--bg-3); }
    .title{ font-size:16px; font-weight:800; margin:0; }

    /* 세로 피드 */
    #videoContainer{
      position: fixed; top:52px; left:0; right:0; bottom:0;
      scroll-snap-type: y mandatory;
      overscroll-behavior-y: contain;
      overflow-y: auto; background:#000;
    }
    .video{ height: calc(100vh - 52px); scroll-snap-align:start; display:flex; align-items:center; justify-content:center; background:#000; position:relative; }
    .video iframe{ width:100%; height:100%; border:0; }

    .meta{
      position:absolute; left:0; right:0; bottom:0;
      padding:8px 10px 10px; background: linear-gradient(transparent, rgba(0,0,0,.6));
      font-size:12px; color:#d8d8d8;
    }
    .meta .t{ font-size:14px; font-weight:800; color:#fff; margin-bottom:2px; display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; }

    .hint{ position:fixed; left:0; right:0; top:52px; padding:8px 12px; background:#0f0f0f; border-bottom:1px solid #1f1f1f; color:#d0d0d0; font-size:13px; display:none; }
    .hint.show{ display:block; }
  </style>
</head>
<body>
  <header id="topbar">
    <div class="brand">
      <button id="btnBack" class="icon" aria-label="뒤로가기">←</button>
      <img class="brand-logo" src="/image/arktube_side.png" alt="ArkTube"/>
    </div>
    <h1 class="title" id="headTitle">시청</h1>
    <div style="width:28px"></div>
  </header>

  <div id="hint" class="hint">목록을 불러오는 중…</div>

  <main id="videoContainer" aria-live="polite"></main>

  <!-- 스크립트 -->
  <script type="module" src="/js/firebase-init.js"></script>
  <script type="module" src="/js/categories.js"></script>
  <script type="module" src="/js/resume.js"></script>
  <script type="module" src="/js/watch.js"></script>
</body>
</html>
